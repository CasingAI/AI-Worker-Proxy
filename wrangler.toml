name = "ai-worker-proxy"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Cloudflare dashboard logs (optional)
[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = false

# ====================================================================================
# EXAMPLE CONFIGURATION
# ====================================================================================
# This [vars] section contains example configuration.
# GitHub Actions will REPLACE it with real ROUTES_CONFIG from GitHub Variable.
# Secrets (PROXY_AUTH_TOKEN, API keys) are set in Cloudflare Dashboard manually.
# ====================================================================================

[vars]
# Model routing configuration (example - will be replaced by GitHub Actions)
ROUTES_CONFIG = '''
{
  "openai-main": [
    {
      "provider": "openai",
      "model": "gpt-4.1",
      "apiKeys": ["OPENAI_KEY_1", "OPENAI_KEY_2"]
    }
  ],
  "glm-main": [
    {
      "provider": "zhipu",
      "model": "glm-4.7-flash",
      "apiKeys": ["ZHIPU_KEY_1"]
    }
  ],
  "zhipu-flash-latest": [
    {
      "provider": "zhipu",
      "model": "glm-4.7-flash",
      "apiKeys": ["ZHIPU_KEY_1"]
    }
  ],
  "fallback-mix": [
    {
      "provider": "zhipu",
      "model": "glm-4.7",
      "apiKeys": ["ZHIPU_KEY_1"]
    },
    {
      "provider": "openai",
      "model": "gpt-4.1-mini",
      "apiKeys": ["OPENAI_KEY_1"]
    }
  ]
}
'''
PROXY_AUTH_TOKEN = "testGiuyghi"

# Secrets to set in Cloudflare Dashboard:
# - PROXY_AUTH_TOKEN
# - OPENAI_KEY_1, OPENAI_KEY_2
# - ZHIPU_KEY_1
