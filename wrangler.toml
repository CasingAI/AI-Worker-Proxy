name = "ai-worker-proxy"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Cloudflare dashboard logs (optional)
[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = false

# ====================================================================================
# EXAMPLE CONFIGURATION
# ====================================================================================
# This [vars] section contains example configuration.
# GitHub Actions will REPLACE it with real ROUTES_CONFIG from GitHub Variable.
# Secrets (PROXY_AUTH_TOKEN, API keys) are set in Cloudflare Dashboard manually.
# ====================================================================================

[vars]
# Model routing configuration (example - will be replaced by GitHub Actions)
ROUTES_CONFIG = '''
{
  "zhipu-flash-latest": {
    "providers": [
      {
        "provider": "zhipu",
        "model": "glm-4.7-flash",
        "apiKeys": ["ZHIPU_KEY_1"],
        "context_window": 200000,
        "max_output_tokens": 16384,
        "description": "GLM-4.7-Flash（FlashX 定价）",
        "pricing_currency": "cny",
        "input_price_per_1m": 0.5,
        "input_cache_price_per_1m": 0.1,
        "output_price_per_1m": 3
      }
    ],
    "metadata": {
      "flash_version": "FlashX",
      "tier": "flash"
    }
  }
}
'''
PROXY_AUTH_TOKEN = "testGiuyghi"

# Secrets to set in Cloudflare Dashboard:
# - PROXY_AUTH_TOKEN
# - OPENAI_KEY_1, OPENAI_KEY_2
# - ZHIPU_KEY_1
